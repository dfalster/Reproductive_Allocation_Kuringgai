```{r, echo=FALSE,message=FALSE,warning=FALSE, fig.width=20, fig.height=20}
par(mfrow=c(4,4), cex=1, omi=c(.7,.7,.1,.1), mai=c(.7,.9,.4,0.2)) 
yvar <- "shoot_leaf_area"
xvar <- "leaf_area"

data <- subset(SummaryInd)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results

for(spp in names(data)) {
  plot_yvar_vs_xvar(data[[spp]], yvar, xvar,log="xy",xlab="",ylab="",cex=1.3,
                    main=spp,col=col.age(data[[spp]]$age))
}

mtext("Shoot leaf area", 2, outer=TRUE,cex=1.2)
mtext("Leaf area", 1, outer=TRUE,cex=1.2)
legend("topleft",legend=labels.age(),col=col.age(),pch=16, cex=1.1,bty="n")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE, fig.width=20, fig.height=20}
par(mfrow=c(4,4), cex=1, omi=c(.7,.7,.1,.1), mai=c(1.1,.7,.6,0.2)) 
yvar <- "growth_height_log"
xvar <- "RA"
xvar2 <- "growth_inv"

data <- subset(SummaryInd,reproducing==TRUE&age>2)
data <- split(data, data$species)

for(spp in names(data)) {
  plot_yvar_vs_xvar(data[[spp]], yvar, xvar,log="",xlab="repro",ylab="",cex=1.3, main=spp,col=col.age(data[[spp]]$age))
  plot_yvar_vs_xvar(data[[spp]], yvar, xvar2,log="x",xlab="veg", ylab="", cex=1.3, main=spp,col=col.age(data[[spp]]$age))
}

mtext("Height growth (log-log)", 2, outer=TRUE,cex=1.2)
mtext("Reproductive investment", 1, outer=TRUE,cex=1.2)
legend("topleft",legend=labels.age(),col=col.age(),pch=16, cex=1.1,bty="n")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE, fig.width=20, fig.height=20}
savpar(mfrow=c(4,4), cex=1, omi=c(.7,.7,.1,.1), mai=c(1.1,.7,.6,0.2)) 
yvar <- "total_inv"
xvar <- "leaf_area_0"

data <- subset(SummaryInd,age>2)

data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results
saved <- results[,1:2]

for(spp in names(data)) {
  plot_yvar_vs_xvar(data[[spp]], yvar, xvar,log="xy",xlab="",ylab="",cex=1.3, main=spp,col=col.age(data[[spp]]$age))
 }

mtext("Height growth (log-log)", 2, outer=TRUE,cex=1.2)
mtext("Reproductive investment", 1, outer=TRUE,cex=1.2)
legend("topleft",legend=labels.age(),col=col.age(),pch=16, cex=1.1,bty="n")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE, fig.width=20, fig.height=20}
par(mfrow=c(4,4), cex=1, omi=c(.7,.7,.1,.1), mai=c(1.1,.7,.6,0.2)) 
yvar <- "total_inv"
xvar <- "leaf_area_0"

data <- subset(SummaryInd)
data <- split(data, data$species)

lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results
saved <- bind_cols(saved,results[2])

for(spp in names(data)) {
  plot_yvar_vs_xvar(data[[spp]], yvar, xvar,log="xy",xlab="",ylab="",cex=1.3, main=spp,col=col.age(data[[spp]]$age))
 }

mtext("Height growth (log-log)", 2, outer=TRUE,cex=1.2)
mtext("Reproductive investment", 1, outer=TRUE,cex=1.2)
legend("topleft",legend=labels.age(),col=col.age(),pch=16, cex=1.1,bty="n")
```
