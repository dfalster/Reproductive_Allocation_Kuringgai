```{r}
win.metafile("figs2/best_correlate2.wmf", height=6, width=12)
plot

par(mfrow=c(1,3), cex=1, omi=c(.4,0.3,.3,0.3), mai=c(1.1,1,.3,0.3))
plot(propagule_inv~total_weight_0,data=subset(SummaryInd,propagule_inv>0),col=col.spp(species),pch=16,log="xy")
mod <- lm(log10(total_weight_0)~log10(propagule_inv),data=subset(SummaryInd,propagule_inv>0))
words.top.left.logxy(mod)

plot(repro_inv~total_weight_0,data=subset(SummaryInd,repro_inv>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000))
mod <- lm(log10(total_weight_0)~log10(repro_inv),data=subset(SummaryInd,repro_inv>0))
words.top.left.logxy(mod)

plot(prepollen_all_inv~total_weight_0,data=subset(SummaryInd,prepollen_all_inv>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000))
mod <- lm(log10(total_weight_0)~log10(prepollen_all_inv),data=subset(SummaryInd,prepollen_all_inv>0))
words.top.left.logxy(mod)

dev.off()
```


```{r}
win.metafile("figs2/acc_cost_seed_size_4panel.wmf", height=9, width=9)

plot
par(mfrow=c(2,2), cex=1, omi=c(.1,.1,.1,.1), mai=c(1,1,.5,.5)) 
options(scipen = 5)

plot(accessory_per_seed ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="total per seed accessory costs")
mod <- lm(log10(accessory_per_seed) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0))
words.top.left.logxy(mod)
slopes <- sma(log10(accessory_per_seed) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],slope.test=1))
summary(slopes)
slopes2 <- as.matrix(coef(slopes))
abline((slopes2[1]),(slopes2[2]))
abline((slopes2[1]),1,col="red")

plot(b_div_p ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="pre-pollination accessory costs")
mod <- lm(log10(b_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0))
words.top.left.logxy(mod)
slopes <- sma(log10(b_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],slope.test=1))
summary(slopes)
slopes2 <- as.matrix(coef(slopes))
abline((slopes2[1]),(slopes2[2]))
abline((slopes2[1]),1,col="red")

plot(c_div_p ~ seed_size,data=subset(SummarySpp[["mean"]],species!="COER"),col=col.spp(species),pch=16,log="xy", ylab="aborted fruit accessory costs")
mod <- lm(log10(c_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0&species!="COER"&species!="BAER"))
words.top.left.logxy(mod)
slopes <- sma(log10(c_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],species!="COER"&species!="BAER"),slope.test=1)
summary(slopes)
slopes2 <- as.matrix(coef(slopes))
abline((slopes2[1]),(slopes2[2]))
abline((slopes2[1]),1,col="red")

plot(dispersalcosts_increment ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="dispersal & packaging accessory costs")
mod <- lm(log10(dispersalcosts_increment) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],species!="LEES"))
words.top.left.logxy(mod)
slopes <- sma(log10(dispersalcosts_increment) ~ log10(seed_size),data=subset(SummarySpp[["mean"]]),slope.test=1)
summary(slopes)
slopes2 <- as.matrix(coef(slopes))
abline((slopes2[1]),(slopes2[2]))
abline((slopes2[1]),1,col="red")
dev.off()
```

#all species show a strong correlation between seedset and the proportion of reproductive investment that is for propagules. However, the slope of the relationship is hugely different across species - some species can still have very low seedset, but show a big shift in what proportion of their energy goes to propagules
##would be good for lines for each species  to just extend from 0 to max seedset for that species
```{r}
win.metafile("figs2/seedset_vs_propPropagule.wmf", height=6, width=6)
 
plot
par(mfrow=c(1,1), cex=1, omi=c(.4,0.3,.3,0.3), mai=c(1.1,1,.3,0.3))

yvar <- "seedset"
xvar <- "prop_propagule"

data <- subset(SummaryInd,seedset>0&prop_propagule>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

plot(seedset ~ prop_propagule,data=subset(SummaryInd,seedset>0&prop_propagule>0&age>2),col=col.spp(species),pch=16,log="xy")
legend("topleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")


for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}


dev.off()

yvar <- "seedset"
xvar <- "prop_propagule"

data <- subset(SummaryInd,seedset>0&prop_propagule>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log(x[[yvar]]) ~  (log(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
write.csv(results, file="figs2/seedset_vs_proppropagule.csv",row.names=FALSE)
```

```{r}
win.metafile("figs2/seedset_vs_seedsize.wmf", height=6, width=6)
plot

par(mfrow=c(1,1), cex=1, omi=c(.1,.1,.1,.1), mai=c(1,1,.5,.5))

plot(seedset ~ seed_size,data=subset(SummaryInd,seedset>0),col=col.spp(species),pch=16,log="xy")
points(seedset ~ seed_size,data=subset(SummarySpp[["mean"]],seedset>0),col=col.spp(species),pch=16,cex=2)
mod <-lm(log10(seed_size) ~ log10(seedset),data=subset(SummarySpp[["mean"]],seedset>0))
words.bottom.left.logxy(mod)
dev.off()
```

```{r}
xvar <- "seedset"
yvar <- "prop_propagule"

data <- subset(SummaryInd,aprop_propagule>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results
#write.csv(results, file="figs2/seedset_vs_accessory.csv",row.names=FALSE)

#win.metafile("figs2/seedset_vs_accessory.wmf", height=6, width=6)
#plot

par(mfrow=c(1,1), cex=1, omi=c(1,1,.1,.1), mai=c(1,1,.5,.5)) 

plot(prop_propagule~seedset,data=subset(SummaryInd,prop_propagule>0&seedset>0&age>2),col=col.spp(species),pch=16,log="xy")
points(prop_propagule~seedset,data=subset(SummarySpp[["mean"]],prop_propagule>0&seedset>0),col="black",pch=16,cex=2.5)
points(prop_propagule~seedset,data=subset(SummarySpp[["mean"]],prop_propagule>0&seedset>0),col=col.spp(species),pch=16,cex=2)
mod <- lm(log10(prop_propagule)~log10(seedset),data=subset(SummarySpp[["mean"]]))
words.top.right.logxy(mod)
for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
abline(coef(mod)[1],coef(mod)[2],lwd=3)
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")
#dev.off()
```



```{r}
xvar <- "seedset"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results
write.csv(results, file="figs2/seedset_vs_accessory.csv",row.names=FALSE)

win.metafile("figs2/seedset_vs_accessory.wmf", height=6, width=6)
plot

par(mfrow=c(1,1), cex=1, omi=c(1,1,.1,.1), mai=c(1,1,.5,.5)) 

plot(accessory_per_seed~seedset,data=subset(SummaryInd,accessory_per_seed>0&seedset>0&age>2),col=col.spp(species),pch=16,log="xy")
points(accessory_per_seed~seedset,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seedset>0),col="black",pch=16,cex=2.5)
points(accessory_per_seed~seedset,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seedset>0),col=col.spp(species),pch=16,cex=2)
mod <- lm(log10(accessory_per_seed)~log10(seedset),data=subset(SummarySpp[["mean"]]))
words.top.right.logxy(mod)
for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
abline(coef(mod)[1],coef(mod)[2],lwd=3)
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")
dev.off()
```

```{r}
xvar <- "seed_count"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results


par(mfrow=c(1,1), cex=1, omi=c(1,1,.1,.1), mai=c(1,1,.5,.5)) 

plot(accessory_per_seed~seed_count,data=subset(SummaryInd,accessory_per_seed>0&seed_count>0&age>2),col=col.spp(species),pch=16,log="xy")
points(accessory_per_seed~seed_count,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seed_count>0),col="black",pch=16,cex=2.5)
points(accessory_per_seed~seed_count,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seed_count>0),col=col.spp(species),pch=16,cex=2)
mod <- lm(log10(accessory_per_seed)~log10(seed_count),data=subset(SummarySpp[["mean"]]))
words.top.right.logxy(mod)
for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
abline(coef(mod)[1],coef(mod)[2],lwd=3)
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

```

```{r}
par(mfrow=c(4,4), cex=1, omi=c(.1,.1,.1,.1), mai=c(.5,.5,.5,.5)) 
xvar <- "seed_count"
yvar <- "b_div_p"

data <- subset(SummaryInd,b_div_p>0&age>2&seed_count>0)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results
write.csv(results, file="figs2/seedcount_vs_b_div_p.csv",row.names=FALSE)
```

```{r}
par(mfrow=c(4,4), cex=1, omi=c(.1,.1,.1,.1), mai=c(.5,.5,.5,.5)) 
xvar <- "seed_count"
yvar <- "c_div_p"

data <- subset(SummaryInd,c_div_p>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results

write.csv(results, file="figs2/seedcount_vs_c_div_p.csv",row.names=FALSE)
```

```{r}
par(mfrow=c(4,4), cex=1, omi=c(.1,.1,.1,.1), mai=c(.5,.5,.5,.5)) 
xvar <- "seed_count"
yvar <- "packaging_dispersal_per_seed"

data <- subset(SummaryInd,packaging_dispersal_per_seed>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)
results$ovules <- c(60,4,15,15,2,2,2,4,1,40,2,20,2)

write.csv(results, file="figs2/seedcount_vs_packdisp.csv",row.names=FALSE)

win.metafile("figs2/dispcosts_vs_ovules.wmf", height=6, width=6)
plot
par(mfrow=c(1,1), cex=1, omi=c(.4,.4,.1,.1), mai=c(.8,.8,.2,.2)) 
plot(ovules~r.squared,results,log="y",col=col.spp(species),pch=16,cex=2,las=.1)
mod <- lm(r.squared~log10(ovules),results)
words.bottom.right.logy(mod)
dev.off()
```
