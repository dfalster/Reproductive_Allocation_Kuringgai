#Figure 1. Correlations of various reproductive investment categories against plant weight
```{r}
win.metafile("figs2/Figure01_correlations_with_plant_weight.wmf", height=9, width=13)
plot

par(mfrow=c(2,3), cex=1, omi=c(1,0.1,.1,0.05), mai=c(.2,.55,.1,0.1))
options(scipen = 2)

plot(propagule_inv~total_weight_0,data=subset(SummaryInd,propagule_inv>0),col=col.spp(species),pch=16,log="xy",xlab="",xlim=c(10,10000000),ylim=c(1,1000000),xaxt="n",ylab="")
mod <- lm(log10(total_weight_0)~log10(propagule_inv),data=subset(SummaryInd,propagule_inv>0))
words.top.left.logxy(mod)
mtext(text="investment in propagules (mg)",side=2,line=2.3,outer=FALSE)

plot(fruit_weight~total_weight_0,data=subset(SummaryInd,fruit_weight>0),col=col.spp(species),pch=16,log="xy",xlab="",xlim=c(10,10000000),ylim=c(1,1000000),xaxt="n",ylab="",yaxt="n")
mod <- lm(log10(total_weight_0)~log10(fruit_weight),data=subset(SummaryInd,fruit_weight>0))
words.top.left.logxy(mod)
mtext(text="investment in fruit (mg)",side=2,line=0.6,outer=FALSE)

plot(repro_all_count~total_weight_0,data=subset(SummaryInd,repro_all_count>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000),xlab="",ylab="",yaxt="n",xaxt="n")
mod <- lm(log10(total_weight_0)~log10(repro_all_count),data=subset(SummaryInd,repro_all_count>0))
words.top.left.logxy(mod)
mtext(text="count of all reproductive units",side=2,line=0.6,outer=FALSE)

mtext(text="total plant weight (mg)",side=1,line=1.5,outer=TRUE)
plot(prepollen_all_inv~total_weight_0,data=subset(SummaryInd,prepollen_all_inv>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000),xlab="",ylab="")
mod <- lm(log10(total_weight_0)~log10(prepollen_all_inv),data=subset(SummaryInd,prepollen_all_inv>0))
words.top.left.logxy(mod)
mtext(text="investment in prepollination tissues (mg)",side=2,line=2.3,outer=FALSE)

plot(repro_inv~total_weight_0,data=subset(SummaryInd,repro_inv>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000),xlab="",ylab="",yaxt="n")
mod <- lm(log10(total_weight_0)~log10(repro_inv),data=subset(SummaryInd,repro_inv>0))
words.top.left.logxy(mod)
mtext(text="total reproductive investment (mg)",side=2,line=0.6,outer=FALSE)

plot(seed_count~total_weight_0,data=subset(SummaryInd,seed_count>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000),xlab="",ylab="",yaxt="n")
mod <- lm(log10(total_weight_0)~log10(seed_count),data=subset(SummaryInd,seed_count>0))
words.top.left.logxy(mod)
mtext(text="seed count",side=2,line=0.6,outer=FALSE)

mtext(text="total plant weight (mg)",side=1,line=1.5,outer=TRUE)


dev.off()
```


#Appendix Fig 1. Correlations with leaf investment  
* if you change conditions to "growth_leaf>50" to remove those old individuals that are no longer replacing leaves, the correlations become ~2x as strong
```{r}
win.metafile("figs2/Appendix01_correlations_with_leaf_investment.wmf", height=9, width=9)
plot

par(mfrow=c(2,2), cex=1, omi=c(.4,0.3,.3,0.1), mai=c(1.1,1,.3,0.1))
plot(propagule_inv~growth_leaf,data=subset(SummaryInd,propagule_inv>0&growth_leaf>0),col=col.spp(species),pch=16,log="xy")
mod <- lm(log10(growth_leaf)~log10(propagule_inv),data=subset(SummaryInd,propagule_inv>0&growth_leaf>0))
words.top.left.logxy(mod)

plot(fruit_weight~growth_leaf,data=subset(SummaryInd,fruit_weight>0&growth_leaf>0),col=col.spp(species),pch=16,log="xy")
mod <- lm(log10(growth_leaf)~log10(fruit_weight),data=subset(SummaryInd,fruit_weight>0&growth_leaf>0))
words.top.left.logxy(mod)

plot(repro_inv~growth_leaf,data=subset(SummaryInd,repro_inv>0&growth_leaf>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000))
mod <- lm(log10(growth_leaf)~log10(repro_inv),data=subset(SummaryInd,repro_inv>0&growth_leaf>0))
words.top.left.logxy(mod)

plot(prepollen_all_inv~growth_leaf,data=subset(SummaryInd,prepollen_all_inv>0&growth_leaf>0),col=col.spp(species),pch=16,log="xy",xlim=c(10,10000000),ylim=c(1,1000000))
mod <- lm(log10(growth_leaf)~log10(prepollen_all_inv),data=subset(SummaryInd,prepollen_all_inv>0&growth_leaf>0))
words.top.left.logxy(mod)

dev.off()
```

#Table showing accessory cost values for the species
```{r}
acc_costs_spp <- dplyr::select(SummarySpp[["mean"]],species,seed_size,seed_to_ovule_ratio,accessory_per_seed,total_accessory_Lord,prepollencosts,b_div_p,c_div_p,dispersalcosts_increment,dispersalcosts_increment2)
acc_costs_spp$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
acc_costs_spp$seed_to_ovule_ratio <- round(acc_costs_spp$seed_to_ovule_ratio,digits=3)
acc_costs_spp$accessory_per_seed <- round(acc_costs_spp$accessory_per_seed,digits=2)
acc_costs_spp$total_accessory_Lord <- round(acc_costs_spp$total_accessory_Lord,digits=2)
acc_costs_spp$b_div_p <- round(acc_costs_spp$b_div_p,digits=2)
acc_costs_spp$c_div_p <- round(acc_costs_spp$c_div_p,digits=2)
acc_costs_spp$dispersalcosts_increment <- round(acc_costs_spp$dispersalcosts_increment,digits=2)
acc_costs_spp$dispersalcosts_increment2 <- round(acc_costs_spp$dispersalcosts_increment2,digits=2)

write.csv(acc_costs_spp, file="figs2/Table01_AccCosts_by_Species.csv",row.names=FALSE)
```

#Figure 2 and Table 2. Scaling of accessory costs versus seed size, by species
```{r}
win.metafile("figs2/Figure02_acc_cost_seed_size_4panel.wmf", height=9, width=9)
plot

par(mfrow=c(2,2), cex=1, omi=c(.5,.1,.1,.1), mai=c(.1,1,.3,.1)) 
options(scipen = 5)

plot(accessory_per_seed ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="total per seed accessory costs",xlab="",xaxt="n")
mod <- lm(log10(accessory_per_seed) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0))
words.top.left.logxy(mod)
slopes <- sma(log10(accessory_per_seed) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],slope.test=1))
#summary(slopes)
slopes2 <- as.matrix(coef(slopes))
abline((slopes2[1]),(slopes2[2]))
abline((slopes2[1]),1,col="red")

plot(b_div_p ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="pre-pollination accessory costs",xlab="",xaxt="n")
mod <- lm(log10(b_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0))
words.top.left.logxy(mod)
slopes <- sma(log10(b_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],slope.test=1,groupsummary=TRUE))
#summary(slopes)

slopes3 <- as.matrix(coef(slopes))
abline((slopes3[1]),(slopes2[2]))
abline((slopes3[1]),1,col="red")

plot(c_div_p ~ seed_size,data=subset(SummarySpp[["mean"]],species!="COER"),col=col.spp(species),pch=16,log="xy", ylab="aborted fruit accessory costs",xlab="")
mod <- lm(log10(c_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],accessory_per_seed>0&species!="COER"&species!="BAER"))
words.top.left.logxy(mod)
slopes <- sma(log10(c_div_p) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],species!="COER"&species!="BAER"),slope.test=1)
#summary(slopes)
slopes4 <- as.matrix(coef(slopes))
abline((slopes4[1]),(slopes2[2]))
abline((slopes4[1]),1,col="red")

plot(dispersalcosts_increment ~ seed_size,data=subset(SummarySpp[["mean"]]),col=col.spp(species),pch=16,log="xy", ylab="dispersal & packaging accessory costs",xlab="")
mod <- lm(log10(dispersalcosts_increment) ~ log10(seed_size),data=subset(SummarySpp[["mean"]],species!="LEES"))
words.top.left.logxy(mod)
slopes <- sma(log10(dispersalcosts_increment) ~ log10(seed_size),data=subset(SummarySpp[["mean"]]),slope.test=1)
#slopes5 <- as.matrix(sma(log10(dispersalcosts_increment) ~ log10(seed_size),data=subset(SummarySpp[["mean"]]),slope.test=1)[1])

slopes5 <- as.matrix(coef(slopes))
abline((slopes5[1]),(slopes2[2]))
abline((slopes5[1]),1,col="red")

Table2 <- data.frame(component=c("total accessory costs","b div p","c div p","dispersal"))
Table2$intercept = c(slopes2[1],slopes3[1],slopes4[1],slopes5[1])
Table2$slope = c(slopes2[2],slopes3[2],slopes4[2],slopes5[2])
write.csv(Table2, file="figs2/Table02_AccCosts_coeff.csv",row.names=FALSE)

mtext(text="seed size (mg)",side=1,line=1.5,outer=TRUE)

dev.off()
```

```{r}
plot(total_weight_0~seed_size,data=subset(SummaryInd,total_weight_0>0),col=col.spp(species),pch=16,log="xy")
mod <- lm(log10(seed_size)~log10(total_weight),data=subset(SummarySpp[["mean"]],total_weight>0))
words.top.left.logxy(mod)

plot(seedset~seed_size,data=subset(SummaryInd,seedset>0),col=col.spp(species),pch=16,log="xy")
mod <- lm(log10(seed_size)~log10(seedset),data=subset(SummarySpp[["mean"]],seedset>0))
words.top.left.logxy(mod)
```


#Table 3 and Figure 3.Per seed accessory costs are lower in individuals with higher seed count. 
###This effect is true across species, since larger-seeded species produce fewer seeds and have higher per seed accessory costs and true within species, since absolute accessory investment is a function of plant size not seedset
```{r}
win.metafile("figs2/Figure_EXTRA_acc_cost_by_seed_count.wmf", height=5, width=5)
plot

xvar <- "seed_count"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&seed_count>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(1,1,.1,.1), mai=c(1,1,.5,.5)) 

plot(accessory_per_seed~seed_count,data=subset(SummaryInd,accessory_per_seed>0&seed_count>0&age>2),col=col.spp(species),pch=16,log="xy")
points(accessory_per_seed~seed_count,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seed_count>0),col="black",pch=16,cex=2.5)
points(accessory_per_seed~seed_count,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seed_count>0),col=col.spp(species),pch=16,cex=2)
mod <- lm(log10(accessory_per_seed)~log10(seed_count),data=subset(SummarySpp[["mean"]]))
words.top.right.logxy(mod)
for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
abline(coef(mod)[1],coef(mod)[2],lwd=3)
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table03_seedcount_vs_accessory.csv",row.names=FALSE)


dev.off()
```

#Table 3 extra - showing propagule investment instead of seed_count. Could also replace with seedset
```{r}
win.metafile("figs2/Figure_EXTRA_acc_cost_by_seedset.wmf", height=5, width=5)
plot

xvar <- "seedset"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&seedset>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)


par(mfrow=c(1,1), cex=1, omi=c(1,1,.1,.1), mai=c(1,1,.5,.5)) 

plot(accessory_per_seed~seedset,data=subset(SummaryInd,accessory_per_seed>0&seedset>0&age>2),col=col.spp(species),pch=16,log="xy")
#points(accessory_per_seed~seedset,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seedset>0),col="black",pch=16,cex=2.5)
#points(accessory_per_seed~seedset,data=subset(SummarySpp[["mean"]],accessory_per_seed>0&seedset>0),col=col.spp(species),pch=16,cex=2)
mod <- lm(log10(accessory_per_seed)~log10(seedset),data=subset(SummarySpp[["mean"]]))
#words.top.right.logxy(mod)
for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
#abline(coef(mod)[1],coef(mod)[2],lwd=3)
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table03a_seedset_vs_accessory.csv",row.names=FALSE)

dev.off()
```

#Higher RE does not lead to lower accessory costs
```{r}
xvar <- "repro_inv"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&repro_inv>0)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(accessory_per_seed~repro_inv,data=subset(SummaryInd,accessory_per_seed>0&repro_inv),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table04_accessory_vs_RE.csv",row.names=FALSE)
```

#Higher RA does not lead to lower accessory costs
```{r}
xvar <- "RA"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&RA>0)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(accessory_per_seed~RA,data=subset(SummaryInd,accessory_per_seed>0&RA),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table05_accessory_vs_RA.csv",row.names=FALSE)
```

#Not a single species shows a reduction in per seed accessory costs with increased plant size.Indeed, EPMI has higher pre-pollination accessory costs    (slope = 0.38, r2=0.19, p=0.019) and accessory costs due to aborted fruit and seeds (slope = 0.83, r2=0.268, p=0.019) in larger individuals, as larger individuals of this species have lower seedset (slope = -0.31, r2=0.198, p=0.018). GRSP also has a nearly significant decline in seedset in larger individuals (slope = -0.78, r2=0.298, p=0.067).
```{r}
xvar <- "total_weight_0"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&total_weight_0>0)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(accessory_per_seed~total_weight_0,data=subset(SummaryInd,accessory_per_seed>0&total_weight_0>0),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table04c_accessory_vs_total_weight.csv",row.names=FALSE)
```

```{r}
xvar <- "age"
yvar <- "accessory_per_seed"

data <- subset(SummaryInd,accessory_per_seed>0&age>2)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(accessory_per_seed~age,data=subset(SummaryInd,accessory_per_seed>0&age>2),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table04d_accessory_vs_age.csv",row.names=FALSE)
```

```{r}
xvar <- "total_weight"
yvar <- "seedset"

data <- subset(SummaryInd,seedset>0&total_weight>0&age<32)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(seedset~total_weight,data=subset(SummaryInd,seedset>0&total_weight>0),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table06b_total_size_by_seedset.csv",row.names=FALSE)
```

#Considering the individual components of accessory costs vs. seedset - since seedset best predictor of accessory costs
```{r}
xvar <- "seedset"
yvar <- "b_div_p"

data <- subset(SummaryInd,b_div_p>0&seedset)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(b_div_p~seedset,data=subset(SummaryInd,b_div_p>0&seedset>0),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table08a_b_div_p_vs_seedset.csv",row.names=FALSE)
```

```{r}
xvar <- "seedset"
yvar <- "c_div_p"

data <- subset(SummaryInd,c_div_p>0&seedset>0&species!="BAER"&species!="COER")
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(c_div_p~seedset,data=subset(SummaryInd,c_div_p>0&seedset>0&species!="BAER"&species!="COER"),col=col.spp(species),pch=16,log="xy")

for(i in 1:12) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Boronia ledifolia","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table08b_c_div_p_vs_seedset.csv",row.names=FALSE)
```

```{r}
xvar <- "seedset"
yvar <- "packaging_dispersal_per_seed"

data <- subset(SummaryInd,packaging_dispersal_per_seed>0&seedset>0&species!="LEES")
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(packaging_dispersal_per_seed~seedset,data=subset(SummaryInd,packaging_dispersal_per_seed>0&seedset>0&species!="LEES"),col=col.spp(species),pch=16,log="xy")

for(i in 1:13) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table08c_dispersal_vs_seedset.csv",row.names=FALSE)
```

#need to redo this, deleted code that created dataframe
```{r}
win.metafile("figs2/dispcosts_vs_ovules.wmf", height=6, width=6)
plot
par(mfrow=c(1,1), cex=1, omi=c(.4,.4,.1,.1), mai=c(.8,.8,.2,.2)) 
plot(ovules~r.squared,results,log="y",col=col.spp(species),pch=16,cex=2,las=.1)
mod <- lm(r.squared~log10(ovules),results)
words.bottom.right.logy(mod)
dev.off()
```

#For each species the accessory cost components that cause shifts in total accessory costs is different and reflects both which components are largest and whichvary most with some factor - seedset, age, etc.
```{r}
mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="BOLE"))
summary(mod)
species_effects <- as.data.frame(coef(mod))
names(species_effects) = c("BOLE")
species_effects$effects <- c("intercept","packaging&dispersal","b_div_p","c_div_p")

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&species=="BAER"))
summary(mod)
species_effects2 <- as.data.frame(coef(mod))
names(species_effects2) = c("BAER")
species_effects2$effects <- c("intercept","packaging&dispersal","b_div_p")

species_effects <- dplyr::left_join(species_effects, species_effects2, by = "effects")

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&species=="COER"))
summary(mod)
species_effects2 <- as.data.frame(coef(mod))
names(species_effects2) = c("COER")
species_effects2$effects <- c("intercept","packaging&dispersal","b_div_p")
species_effects <- dplyr::left_join(species_effects, species_effects2, by = "effects")

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="EPMI"))
summary(mod)
species_effects2 <- as.data.frame(coef(mod))
names(species_effects2) = c("EPMI")
species_effects2$effects <- c("intercept","packaging&dispersal","b_div_p","c_div_p")
species_effects <- dplyr::left_join(species_effects, species_effects2, by = "effects")

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="GRBU"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="GRSP"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="HATE"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="HEPU"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,age>2&b_div_p>0&c_div_p>0&species=="LEES"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="PELA"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="PEPU"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="PHPH"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="PILI"))
summary(mod)

mod <- lm(log10(accessory_per_seed)~log10(packaging_dispersal_per_seed)+log10(b_div_p)+log10(c_div_p),data=subset(SummaryInd,packaging_dispersal_per_seed>0&age>2&b_div_p>0&c_div_p>0&species=="PUTU"))
summary(mod)
```
#*******************************
#below this line: results probably not used in manuscript
#*******************************
#With increasing seed count, not only do total per seed accessory costs decline, but so do the individual components. 
```{r}
xvar <- "seed_count"
yvar <- "b_div_p"

data <- subset(SummaryInd,b_div_p>0&seed_count)
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(b_div_p~seed_count,data=subset(SummaryInd,b_div_p>0&seed_count>0),col=col.spp(species),pch=16,log="xy")

for(i in 1:14) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table07a_b_div_p_vs_seed_count.csv",row.names=FALSE)
```

```{r}
xvar <- "seed_count"
yvar <- "c_div_p"

data <- subset(SummaryInd,c_div_p>0&seed_count>0&species!="BAER"&species!="COER")
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(c_div_p~seed_count,data=subset(SummaryInd,c_div_p>0&seed_count>0&species!="BAER"&species!="COER"),col=col.spp(species),pch=16,log="xy")

for(i in 1:12) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Boronia ledifolia","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Leucopogon esquamatus","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table07b_c_div_p_vs_seed_count.csv",row.names=FALSE)
```

```{r}
xvar <- "seed_count"
yvar <- "packaging_dispersal_per_seed"

data <- subset(SummaryInd,packaging_dispersal_per_seed>0&seed_count>0&species!="LEES")
data <- split(data, data$species)
lmfits <- lapply(data, function(x) lm(log10(x[[yvar]]) ~  (log10(x[[xvar]]))))
results <- summarise_all_fits(lmfits)

results$r.squared <- round(results$r.squared,digits=3)
results$p.value <- round(results$p.value,digits=3)
results$a <- round(results$a,digits=2)
results$b <- round(results$b,digits=2)

par(mfrow=c(1,1), cex=1, omi=c(.2,.2,.1,.1), mai=c(1,1,.1,.1)) 

plot(packaging_dispersal_per_seed~seed_count,data=subset(SummaryInd,packaging_dispersal_per_seed>0&seed_count>0&species!="LEES"),col=col.spp(species),pch=16,log="xy")

for(i in 1:13) {
abline((results[i,5]),(results[i,6]),col=col.spp(results$species[i]))
}
legend("bottomleft",legend=labels.spp(),col=col.spp(),pch=16, cex=.8,bty="n")

results$species <- c("Banksia ericifolia","Boronia ledifolia","Conospermum ericifolium","Epacris microphylla", "Grevillea buxifolia","Grevillea speciosa","Hakea teretifolia","Hemigenia purpurea","Persoonia lanceolata", "Petrophile puchella", "Phyllota phyllicoides", "Pimelea linifolia", "Pultanaea tuberculata") 
names(results)=c("species","r2","p-value","n","intercept","slope")
results
write.csv(results, file="figs2/Table07c_dispersal_vs_seed_count.csv",row.names=FALSE)
```

